# 操作系统学习（二十八）——死锁的概念

## 知识总览

![image-20200806170845153](F:\笔记\操作系统\assets\操作系统学习（二十八）.png)

## 什么是死锁

![image-20200806171008360](F:\笔记\操作系统\assets\操作系统学习（二十八）-2.png)

![image-20200806171311310](F:\笔记\操作系统\assets\操作系统学习（二十八）-3.png)

## 死锁、饥饿、死循环的区别

死锁：各进程互相等待对方手里的资源，导致各进程都阻塞，无法向前推进的现象。

饥饿：由于长期得不到想要的资源，某进程无法向前推进的现象。比如：在短进程优先（SPF）算法中，若有源源不断的短进程到来，则长进程将一直得不到处理机，从而发生长进程“饥饿”。

死循环：某进程执行过程中一直挑不出某个循环的现象。有时是因为程序逻辑 bug 导致的，有时是程序员故意设计的。

![image-20200806172102003](F:\笔记\操作系统\assets\操作系统学习（二十八）-4.png)

## 死锁产生的必要条件

产生死锁必须同时满足一下四个条件，只要其中任一条件不成立，死锁就不会发生。

* <font color="red">**互斥条件**</font>：只有对必须互斥使用的资源的争抢才会导致死锁（如哲学家的筷子、打印机准备）。像内存、扬声器这样可以同时让多个进程使用的资源是不会导致死锁的（因为进程不用阻塞等待这种资源）。
* <font color="red">**不剥夺条件**</font>：进程所获得的资源在未使用完之前，<font color="red">**不能被其他进程强行夺走**</font>，只能主动释放。
* <font color="red">**请求和保持条件**</font>：进程<font color="red">**已经保持了至少一个资源**</font>，但又提出了新的资源请求，而该资源又被其他进程占用，此时请求进程阻塞，但又对自己已有的资源保持不放。
* <font color="red">**循环等待条件**</font>：存在一种进程<font color="red">**资源的循环等待链**</font>，链中每一个进程已获得的资源同时被下一个进程所请求。

> <font color="red">注意：发生死锁时一定有循环等待，但是发生循环等待时未必死锁（循环等待是死锁的必要不充分条件）
>
> 如果同类资源数大于1，则即使有循环等待，也未必发生死锁。但如果系统中每类资源都只有一个，那循环等待就是死锁的充分必要条件。

## 什么时候会发生死锁

![image-20200806185738322](F:\笔记\操作系统\assets\操作系统学习（二十八）-5.png)

## 死锁的处理策略

1. 预防死锁。破坏死锁产生的四个必要条件中的一个或几个。
2. 避免死锁。用某种方法防止系统进入不安全状态，从而避免死锁（银行家算法）
3. 死锁的检测和解除。允许死锁的发生，不过操作系统会负责检测出死锁的发生，然后采取某种措施解除死锁。